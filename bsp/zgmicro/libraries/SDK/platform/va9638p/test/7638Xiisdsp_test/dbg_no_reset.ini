/******************************************************************************/
/* DEBUG.INI: Debug Initialization File                                       */
/******************************************************************************/

/// Check cpu mode and set it to mode35
FUNC void RunInMode35 (void) {
//#define CKM_BASE 						(0x40000000)
//#define REG_CKM_CM3_SYS_CTRL	(CKM_BASE + 0x80)
  unsigned long int reg;
	
	printf ("random number = %04XH\n", rand(0));

  reg = _RDWORD (0x40000080);

  if((reg & 0x00000001)) return; // already in mod35

	// set to mod35 and reset
	_WDWORD(0x40000080, reg | 0x00000001);
	_sleep_(20);
	exec("RESET");
	_sleep_(20);
}

/// Load the exec target
FUNC void ReloadTarget (void) {
	//LOAD command is illegal after debug start
	//exec("LOAD %L")
	//exec("EXIT");
}

FUNC void ResetDsp(void)
{
    unsigned long int reg;
    
    reg = _RDWORD(0x4004c008);

    _WDWORD(0x4004c008, reg | 0x00000002);      
}

//RunInMode35();

//reload target
LOAD %L INCREMENTAL
//ResetDsp();
//PC=__main
